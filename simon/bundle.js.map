{"version":3,"sources":["webpack:///webpack/bootstrap 10aec0209489a097f228","webpack:///./src/main.ts","webpack:///./src/board.ts","webpack:///./src/canvas.ts","webpack:///./src/constants.ts","webpack:///./src/duration.ts","webpack:///./src/state.ts","webpack:///./src/sound.ts","webpack:///./src/utils.ts","webpack:///./src/consoleLog.ts","webpack:///./~/process/browser.js","webpack:///./src/event.ts","webpack:///./src/handlers.ts","webpack:///./src/replay-timeout.ts","webpack:///./src/tune.ts"],"names":[],"mappings":"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","file":"./dist/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 10aec0209489a097f228\n **/","/*\n * Main programme\n *\n */\n\nimport { redrawBoard } from \"./board\";\nimport { canvasClickHandler, canvasMouseDownHandler, canvasMouseUpOrOutHandler } from \"./event\";\nimport { resetState, State, updateScale } from \"./state\";\nimport { runWhenDocumentReady } from \"./utils\";\n\nrunWhenDocumentReady((): void => {\n\n  /** Holds all the game's state. This is used in many functions as if it was a global variable, its properties\n   * are mutated but the object itself (i.e., the value of the reference) is not modified anywhere*/\n  const state: State = {} as State;\n  resetState(state);\n\n  // Draw the board for the first time\n  redrawBoard(state);\n\n  // Handle mouse clicks on the canvas\n  state.canvas.addEventListener(\"click\", (e: MouseEvent) => canvasClickHandler(state, e), false);\n  state.canvas.addEventListener(\"mousedown\", (e: MouseEvent) => canvasMouseDownHandler(state, e), false);\n  state.canvas.addEventListener(\"mouseup\", (e: MouseEvent) => canvasMouseUpOrOutHandler(state, e), false);\n\n  // If user drags the mouse off the canvas, treat this as a mouseup\n  state.canvas.addEventListener(\"mouseout\", (e: MouseEvent) => {\n    if (e && e.target && e.target === state.canvas) {\n      canvasMouseUpOrOutHandler(state, e);\n    }\n  }, false);\n\n  window.onresize = () => {\n    updateScale(state);\n    redrawBoard(state);\n  };\n\n});\n\n\n\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/main.ts\n **/","/*\n * Functions to (re)draw the board and the score\n *\n */\n\nimport { fillCentredRectangle, fillCentredCircle, fillCentredCircleCleanAlpha, fillNoteButtonShapeCleanAlpha, centredText } from \"./canvas\";\nimport constants, { BoardDimensions, Colours } from \"./constants\";\nimport { Score, State, CanvasButton, buttonToNote } from \"./state\";\nimport { assertNever, timeout } from \"./utils\";\n\n/** Shortcut to constants.boardDimensions to reduce verbosity */\nconst dim: BoardDimensions = constants.boardDimensions;\n\n/** Shortcut to constants.colours to reduce verbosity */\nconst col: Colours = constants.colours;\n\n/** Draw the Simon board on the canvas */\nexport function redrawBoard(state: State): void {\n\n  // Draw the borders\n  fillCentredCircle(state.context, 0, 0, dim.outerBorderOutsideRadius, col.stripe);\n  fillCentredRectangle(state.context, 0, 0, dim.stripeWidth, dim.outerBorderOutsideRadius + dim.outerBorderInsideRadius, col.stripe);\n  fillCentredRectangle(state.context, 0, 0, dim.outerBorderOutsideRadius + dim.outerBorderInsideRadius, dim.stripeWidth, col.stripe);\n  fillCentredCircle(state.context, 0, 0, dim.innerBorderOutsideRadius, col.stripe);\n  fillCentredCircle(state.context, 0, 0, dim.innerBorderInsideRadius, col.centralBackground);\n\n  // Draw the labels for the control buttons\n  centredText(state.context, - 0.5 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.6, \"POWER\", constants.fonts.buttonLabels);\n  centredText(state.context,    0  * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.6, \"START\", constants.fonts.buttonLabels);\n  centredText(state.context, + 0.5 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.6, \"STRICT\", constants.fonts.buttonLabels);\n\n  // Draw the rings around the control buttons\n  fillCentredCircle(state.context, - 0.5 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3,  dim.centralButtonRingRadius, col.buttonRing);\n  fillCentredCircle(state.context,    0   * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3,  dim.centralButtonRingRadius, col.buttonRing);\n  fillCentredCircle(state.context, + 0.5 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3,  dim.centralButtonRingRadius, col.buttonRing);\n\n  // Draw control buttons\n  redrawButton(state, \"StartButton\");\n  redrawButton(state, \"PowerButton\");\n  redrawButton(state, \"StrictButton\");\n\n  // Draw the note buttons\n  redrawNotes(state);\n\n  // Add the score\n  redrawScore(state);\n\n}\n\n/** Redraw all the note buttons */\nexport function redrawNotes(state: State): void {\n  redrawButton(state, \"BlueButton\");\n  redrawButton(state, \"YellowButton\");\n  redrawButton(state, \"GreenButton\");\n  redrawButton(state, \"RedButton\");\n}\n\n/** Redraw a button based on its current state */\nexport function redrawButton(state: State, b: CanvasButton): void {\n\n  switch (b) {\n\n    case \"BlueButton\":\n    fillNoteButtonShapeCleanAlpha(\n        state.context, 0, dim.innerBorderOutsideRadius, dim.outerBorderInsideRadius, dim.stripeWidth / 2,\n        col.stripe, col.blueNote,\n        state.depressed === b || state.playing === buttonToNote(b) ? constants.alphas.brightNote : constants.alphas.normalNote);\n      break;\n\n    case \"YellowButton\":\n    fillNoteButtonShapeCleanAlpha(\n        state.context, 1, dim.innerBorderOutsideRadius, dim.outerBorderInsideRadius, dim.stripeWidth / 2,\n        col.stripe, col.yellowNote,\n        state.depressed === b || state.playing === buttonToNote(b) ? constants.alphas.brightNote : constants.alphas.normalNote);\n      break;\n\n    case \"GreenButton\":\n    fillNoteButtonShapeCleanAlpha(\n        state.context, 2, dim.innerBorderOutsideRadius, dim.outerBorderInsideRadius, dim.stripeWidth / 2,\n        col.stripe, col.greenNote,\n        state.depressed === b || state.playing === buttonToNote(b) ? constants.alphas.brightNote : constants.alphas.normalNote);\n      break;\n\n    case \"RedButton\":\n    fillNoteButtonShapeCleanAlpha(\n        state.context, 3, dim.innerBorderOutsideRadius, dim.outerBorderInsideRadius, dim.stripeWidth / 2,\n        col.stripe, col.redNote,\n        state.depressed === b || state.playing === buttonToNote(b) ? constants.alphas.brightNote : constants.alphas.normalNote);\n      break;\n\n    case \"PowerButton\":\n      fillCentredCircleCleanAlpha(\n        state.context, - 0.5 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3,  dim.centralButtonRadius,\n        col.buttonRing, col.powerButton,\n        state.power ? constants.alphas.onSwitch : constants.alphas.offSwitch);\n      break;\n\n    case \"StartButton\":\n      fillCentredCircleCleanAlpha(\n        state.context, 0 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3,  dim.centralButtonRadius,\n        col.buttonRing, col.startButton,\n        constants.alphas.offSwitch);\n      break;\n\n    case \"StrictButton\":\n      fillCentredCircleCleanAlpha(\n        state.context, + 0.5  * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3,  dim.centralButtonRadius,\n        col.buttonRing, col.strictButton,\n        state.strict && state.power ? constants.alphas.onSwitch : constants.alphas.offSwitch);\n      break;\n\n    default:\n      assertNever(b); // TS Compiler will throw an error if above cases are not exhaustive\n      throw Error(\"Unknown button type in drawButton: \" + b);\n\n  }\n\n}\n\nexport function redrawScore(state: State): void {\n\n  let show: string;\n  if (state.score === \"Blank\") {\n      show = \"\";\n  } else if (state.score === \"Dashes\") {\n      show = \"--\";\n  } else if (state.score === \"Plings\") {\n      show = \"!!\";\n  } else if (state.score === \"Win\") {\n      show = \"WIN\";\n  } else if (typeof state.score === \"number\") {\n      show = (state.score >= 0 && state.score <= 9) ? \"0\" + state.score : state.score.toString();\n  } else {\n      throw Error(\"Bad score in redrawScore:\" + state.score);\n  }\n\n  fillCentredRectangle(\n    state.context,\n    0, -0.3 * dim.innerBorderInsideRadius, 1.4 * dim.innerBorderInsideRadius, 0.7 * dim.innerBorderInsideRadius,\n    col.centralBackground);\n  centredText(state.context, 0, - 0.3 * dim.innerBorderInsideRadius, show, constants.fonts.score);\n\n}\n\n/* Update score in X/blank/X/blank sequence, calling next step after delay and then final callback*/\nexport function flashScore(state: State, x: Score, n: number, finalCb: ((s: State) => void)): void {\n\n  state.score = n % 2 ? \"Blank\" : x;\n  redrawScore(state);\n\n  if (n > 0) {\n\n    timeout(constants.durations.flash, () => flashScore(state, x, n - 1, finalCb));\n\n  } else {\n\n    timeout(constants.durations.finalFlash, () => finalCb(state));\n\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/board.ts\n **/","/*\n * Functions to draw onto the canvas. Functions simply operate on the given\n * canvas context (which they preserve) and have no game or state logic.\n *\n */\n\n/** Fill a rectangle of given width and height that is centred on given coordinates */\nexport function fillCentredRectangle(\n  ctx: CanvasRenderingContext2D,\n  x: number, y: number, w: number, h: number,\n  fillStyle: string): void {\n\n  ctx.save();\n  ctx.fillStyle = fillStyle;\n  ctx.fillRect(x - w / 2,  y - h / 2, w, h);\n  ctx.restore();\n\n}\n\n/** Fill a circle of given radius that is centered of given coordinates */\nexport function fillCentredCircle(\n  ctx: CanvasRenderingContext2D,\n  x: number, y: number, r: number,\n  fillStyle: string, alpha?: number): void {\n\n  ctx.save();\n  ctx.beginPath();\n  ctx.arc(x, y, r, 0 , 2 * Math.PI);\n  ctx.fillStyle = fillStyle;\n  if (alpha) {\n    ctx.globalAlpha = alpha;\n  }\n  ctx.fill();\n  ctx.restore();\n\n}\n\n/** Fill a circle of given radius that is centered of given coordinates first with\n * background fill style (and 100% alpha) then with given fillstyle and alpha\n*/\nexport function fillCentredCircleCleanAlpha(\n  ctx: CanvasRenderingContext2D,\n  x: number, y: number, r: number,\n  bgFillStyle: string, fillStyle: string, alpha: number): void {\n\n  ctx.save();\n  ctx.beginPath();\n  ctx.arc(x, y, r, 0 , 2 * Math.PI);\n  ctx.fillStyle = bgFillStyle;\n  ctx.fill();\n  ctx.fillStyle = fillStyle;\n  ctx.globalAlpha = alpha;\n  ctx.fill();\n  ctx.restore();\n\n}\n\n/** Draw given text centred on coordinate */\nexport function centredText(ctx: CanvasRenderingContext2D, x: number, y: number, t: string, font: string): void {\n\n  ctx.save();\n  ctx.font = font;\n  ctx.textAlign = \"center\";\n  ctx.textBaseline = \"middle\";\n  ctx.fillText(t, x, y);\n  ctx.restore();\n\n}\n\n\n/** Fill the note button shape (a quadrant with missing borders along axis and the middle) centred on the origin\n * twice: once with background fill style (and 100% alpha) and then with given fillstyle and alpha\n */\nexport function fillNoteButtonShapeCleanAlpha(\n  ctx: CanvasRenderingContext2D,\n  quadrant: number, // numbered clockwise 0..3 starting at bottom-right\n  rIn: number, // Inside radius\n  rOut: number, // Outside radius\n  offset: number, // Perpendicular distance from vertices to nearest axis\n  bgFillStyle: string, fillStyle: string, alpha: number\n  ): void {\n\n  /** Angle to axis of an inside vertex of the note button */\n  let thetaIn: number = Math.atan2(offset, rIn);\n\n  /** Angle to axis of an outside vertex of the note button */\n  let thetaOut: number = Math.atan2(offset, rOut);\n\n  /** Angle to rotate the whole button to be in the approprate quadrant */\n  let thetaRotate: number = (quadrant % 4) * Math.PI / 2;\n\n  ctx.save();\n  ctx.beginPath();\n\n  moveToPolar(ctx, rIn, thetaIn + thetaRotate);\n  lineToPolar(ctx, rOut, thetaOut + thetaRotate);\n  ctx.arc(0, 0, rOut, thetaOut + thetaRotate, Math.PI * 0.5 - thetaOut + thetaRotate);\n  lineToPolar(ctx, rIn, Math.PI * 0.5 - thetaIn + thetaRotate);\n  ctx.arc(0, 0, rIn, Math.PI * 0.5 - thetaIn + thetaRotate, thetaIn + thetaRotate, true);\n\n  ctx.fillStyle = bgFillStyle;\n  ctx.fill();\n  ctx.globalAlpha = alpha;\n  ctx.fillStyle = fillStyle;\n  ctx.fill();\n  ctx.restore();\n\n}\n\n/** Helper function to move to given location in polar coordinated */\nfunction moveToPolar(ctx: CanvasRenderingContext2D, r: number, theta: number): void {\n\n  ctx.moveTo(r * Math.cos(theta), r * Math.sin(theta));\n\n}\n\n/** Helper function to add a line to the given location in polar coordinates */\nfunction lineToPolar(ctx: CanvasRenderingContext2D, r: number, theta: number): void {\n\n  ctx.lineTo(r * Math.cos(theta), r * Math.sin(theta));\n\n}\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/canvas.ts\n **/","/*\n * Module holding all the game's constant parameters\n *\n * Used as\n\n * import constant from \"./constant\";\n * let x = constants.boardDimensions.outerBorderOutsideRadius;\n * let y = constants.durations.maxReplyaNote.milliseconds();\n *\n */\n\nimport { Duration, ms } from \"./duration\";\n\n/** Type for our constants default export */\ninterface Constants {\n  logging: boolean;\n  window: WindowParams;\n  boardDimensions: BoardDimensions;\n  durations: Durations;\n  alphas: Alphas;\n  audio: AudioConstants;\n  colours: Colours;\n  fonts: Fonts;\n  game: Game;\n}\n\n/** Type for the window-related parameters */\nexport interface WindowParams {\n\n  /** Canvas width set to window's innerwidth less width reserved */\n  widthReserved: number;\n\n  /** Canvas height set to window's innerwidth less height reserved */\n  heightReserved: number;\n}\n\n/** Type for the boardDimensions part of the constants default export, all in the scaled -100..100 coordinate space */\nexport interface BoardDimensions {\n\n  /** Canvas runs from -canvaSize to +canvasSize on x and y axes */\n  canvasSize: number;\n\n  /** Width of the horizontal and vertical border stripes */\n  stripeWidth: number;\n\n  /** Radius of the outer edge of the black border at the outside of the board */\n  outerBorderOutsideRadius: number;\n\n  /** Radius of the inner edge of the black border at the outside of the board */\n  outerBorderInsideRadius: number;\n\n  /** Radius of the outer edge of the black border at the inside of the note buttons */\n  innerBorderInsideRadius: number;\n\n  /** Radius of the inner edge of the black border at the inside of the note buttons */\n  innerBorderOutsideRadius: number;\n\n  /** Radius of the coloued part of the buttons at the centre of the Simon board */\n  centralButtonRadius: number;\n\n  /** Outside radius of the black ring around the buttons at the centre of the Simon board */\n  centralButtonRingRadius: number;\n}\n\n/** Type for the durations part of the constants default export */\nexport interface Durations {\n\n  /** Length of time for score and blank to appear on screen when flashing the score */\n  flash: Duration;\n\n  /** Length of time for blank to appear on screen at the end of flashing the score */\n  finalFlash: Duration;\n\n  /** Duration of each note when we play the tune */\n  tuneNote: Duration;\n\n  /** Duration of pause between each note when we play the tune */\n  tuneGap: Duration;\n\n  /** Maximum time to wait for a note during replay phase before triggering failure */\n  replayWait: Duration;\n\n  /** Time to wait after completing a replay phase before extending */\n  afterReplay: Duration;\n\n  /** Time to wait after the failure noise */\n  afterFailure: Duration;\n\n  /** Duration of the failure sound */\n  failureSound: Duration;\n}\n\n/** Type for the alpha values for drawing the board */\nexport interface Alphas {\n  normalNote: number;\n  brightNote: number;\n  offSwitch: number;\n  onSwitch: number;\n}\n\n/** Type for the frequencies used to play the notes */\nexport interface AudioConstants {\n  blue: number;\n  yellow: number;\n  red: number;\n  green: number;\n  failure: number;\n  gain: number; // gain value for the gainNode\n};\n\nexport interface Game {\n  winCondition: number; // number of notes that must be matched to win the game\n}\n\ntype Colour = string;\n/** Type for the colours used to draw the board */\nexport interface Colours {\n  stripe: Colour;\n  powerButton: Colour;\n  startButton: Colour;\n  strictButton: Colour;\n  buttonRing: Colour;\n  redNote: Colour;\n  yellowNote: Colour;\n  greenNote: Colour;\n  blueNote: Colour;\n  centralBackground: Colour;\n}\n\ntype Font = string;\n/** Type for th fonts used to draw the board */\nexport interface Fonts {\n  buttonLabels: Font;\n  score: Font;\n}\n\nconst stripeWidth: number = 10;\nconst outsideRadius: number = 100;\nconst insideRadius: number = 30;\n\n/** Values for the constants default export */\nconst constants: Constants = {\n  logging: true,\n  window: {\n    widthReserved: 20,\n    heightReserved: 100\n  },\n  boardDimensions: {\n    canvasSize: 100,\n    stripeWidth,\n    outerBorderOutsideRadius: outsideRadius,\n    outerBorderInsideRadius: outsideRadius - stripeWidth,\n    innerBorderInsideRadius: insideRadius,\n    innerBorderOutsideRadius: insideRadius + stripeWidth,\n    centralButtonRadius: 5,\n    centralButtonRingRadius: 6\n  },\n  durations: {\n    flash: ms(300),\n    finalFlash: ms(800),\n    tuneNote: ms(800),\n    tuneGap: ms(400),\n    replayWait: ms(5000),\n    afterReplay: ms(1000),\n    afterFailure: ms(1000),\n    failureSound: ms(1500)\n  },\n  alphas: {\n    normalNote: 0.75,\n    brightNote: 1,\n    offSwitch: 0.5,\n    onSwitch: 1\n  },\n  audio: {\n    blue: 329.628,\n    yellow: 277.183,\n    red: 440,\n    green: 164.814,\n    failure: 66,\n    gain: 0.1\n  },\n  colours: {\n    stripe: \"black\",\n    powerButton: \"limegreen\",\n    startButton: \"red\",\n    strictButton: \"yellow\",\n    buttonRing: \"black\",\n    redNote: \"red\",\n    yellowNote: \"yellow\",\n    greenNote: \"limegreen\",\n    blueNote: \"dodgerblue\",\n    centralBackground: \"lightgray\"\n  },\n  fonts: {\n    buttonLabels: \"3px sans-serif\",\n    score: \"20px sans-serif\"\n  },\n  game: {\n    winCondition: 20\n  }\n};\n\nexport default constants;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/constants.ts\n **/","/**\n * Duration type used for time intervals. Used to reduce mistakes as setTimeout use milliseconds but\n * the audio interface uses seconds\n *\n */\n\n/** Interface used for all time intervals to avoid seconds/milliseconds confusions */\nexport interface Duration {\n  seconds(): number;\n  millseconds(): number;\n}\n\n/** Create a Duration object from a millisecond value */\nexport function ms(x: number): Duration {\n  return {\n    millseconds: () => x,\n    seconds: () => x / 1000\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/duration.ts\n **/","/*\n * Define the games shared state and related initialization, types and conversions\n *\n */\n\nimport constants from \"./constants\";\nimport { AudioState, newAudioState } from \"./sound\";\nimport { assertNever, getContext2D } from \"./utils\";\n\n/** Buttons on the Simon board */\nexport type CanvasButton =\n  \"BlueButton\" | \"YellowButton\" | \"GreenButton\" | \"RedButton\" | \"StartButton\" | \"StrictButton\" | \"PowerButton\";\n\n/** Notes that can be played and be part of tunes */\nexport type Note =\n  \"BlueNote\" | \"GreenNote\" | \"YellowNote\" | \"RedNote\";\n\n/** Values that can be sent for display on the scoreboard */\nexport type Score =\n  number | \"Blank\" | \"Dashes\" | \"Plings\" | \"Win\";\n\n/** Global state that will be shared between modules */\nexport interface State {\n\n  // Graphics\n  canvas: HTMLCanvasElement;\n  context: CanvasRenderingContext2D;\n  scale: number | undefined;\n  depressed: CanvasButton | null;\n  playing: Note | null;\n  score: Score; // To appear in the score window\n\n  // Sound\n  audio: AudioState;\n\n  // Game logic\n  tune: Note[]; //\n  notesMatched: number | null; // gives number of next note in tune expected, or null if not expecting notes\n  id: number; // Incremented each time a new tune starts\n\n  // Switches\n  power: boolean;\n  strict: boolean;\n\n}\n\n/** Reset the given state (e.g. at start, power off or after a win), preserve graphics and audio contexts and id */\nexport function resetState(state: State): void {\n\n  state.canvas = state.canvas || document.getElementById(\"board\") as HTMLCanvasElement;\n  state.context = state.context || getContext2D(state.canvas);\n  state.scale = undefined;\n  state.depressed = null;\n  state.playing = null;\n  state.score = \"Blank\";\n\n  state.audio = state.audio || newAudioState();\n\n  state.tune = [];\n  state.notesMatched = null;\n  state.id = state.id ? state.id++ : 0;\n\n  state.power = false;\n  state.strict = false;\n\n  updateScale(state);\n\n}\n\n/** Modify state to reflect canvas and window size */\nexport function updateScale(state: State): void {\n\n  // We set the canvas to fill most of the available window\n  state.canvas.width = window.innerWidth - constants.window.widthReserved;\n  state.canvas.height = window.innerHeight - constants.window.heightReserved;\n\n  // We transform the canvas so a square with coordinates (-100, -100) to (100, 100)\n  // appears as the largest centred squate that will fit on the canvas\n  state.scale = Math.min(state.canvas.width, state.canvas.height) / (2 * constants.boardDimensions.canvasSize);\n  state.context.transform(state.scale, 0, 0, state.scale, state.canvas.width / 2, state.canvas.height / 2);\n\n}\n\n\n/** Helper function to convert between Buttons and Notes */\nexport function buttonToNote(b: CanvasButton): Note {\n\n  switch (b) {\n    case \"BlueButton\":\n      return \"BlueNote\";\n    case \"YellowButton\":\n      return \"YellowNote\";\n    case \"GreenButton\":\n      return \"GreenNote\";\n    case \"RedButton\":\n      return \"RedNote\";\n    case \"StartButton\":\n    case \"PowerButton\":\n    case \"StrictButton\":\n      throw Error(\"Bad button type in buttonToNote:\" + b);\n    default:\n      assertNever(b); // TS Compiler will throw an error if above cases are not exhaustive\n      throw Error(\"Unknown button in buttonToNote:\" + b);\n  }\n\n}\n\n/** Helper function to convert between Notes and Buttons */\nexport function noteToButton(n: Note): CanvasButton {\n\n  switch (n) {\n    case \"BlueNote\":\n      return \"BlueButton\";\n    case \"YellowNote\":\n      return \"YellowButton\";\n    case \"GreenNote\":\n      return \"GreenButton\";\n    case \"RedNote\":\n      return \"RedButton\";\n    default:\n      assertNever(n); // TS Compiler will throw an error if above cases are not exhaustive\n      throw Error(\"Bad note in noteToButton:\" + n);\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/state.ts\n **/","/*\n * Manage sound playing and state, no game logic\n *\n */\n\nimport constants from \"./constants\";\nimport { Duration } from \"./duration\";\nimport { Note } from \"./state\";\nimport { assertNever, eventLog, log } from \"./utils\";\n\n/** Audio-relevant portion of the overall game State */\nexport interface AudioState {\n  context: AudioContext;\n  gainNode: GainNode;\n  playingSound: OscillatorNode | null;\n}\n\n// Safari uses webkitAudioContext instead of the standard AudioContext. TypeScript library headers\n// only provide the latter, so we provide a copy here for webkitAudioContext\ndeclare var webkitAudioContext: {\n    prototype: AudioContext;\n    new(): AudioContext;\n};\n\n/** Initialize sound system, updating state */\nexport function newAudioState(): AudioState {\n\n  // Get the AudioContext from either the standard AudioContext or the Safari-esque webkitAudioContext\n  let context: AudioContext | undefined = undefined;\n  if (\"AudioContext\" in window) {\n    context = new AudioContext();\n  } else if (\"webkitAudioContext\" in window) {\n    context = new webkitAudioContext();\n  }\n  if (!context) {\n    throw Error(\"Failed to create AudioContext\");\n  }\n\n  let gainNode: GainNode = context.createGain();\n  gainNode.gain.value = constants.audio.gain;\n  gainNode.connect(context.destination);\n\n  return { context, gainNode, playingSound: null };\n\n}\n\n/** Start playing the given note, stopping after the optional duration and applying the optional callback */\nexport function startPlayingSound(audio: AudioState, n: Note, dur?: Duration, cb?: (() => void)): void {\n\n  eventLog(\"StrtPl\", n, \"\");\n\n  let osc: OscillatorNode | undefined = audio.context.createOscillator();\n  if (!osc) {\n    throw Error(\"Failed to create oscillator node\");\n  }\n  osc.type = \"square\";\n  osc.connect(audio.gainNode);\n\n  switch (n) {\n    case \"BlueNote\":\n      osc.frequency.value = constants.audio.blue;\n      break;\n    case \"YellowNote\":\n      osc.frequency.value = constants.audio.yellow;\n      break;\n    case \"RedNote\":\n      osc.frequency.value = constants.audio.red;\n      break;\n    case \"GreenNote\":\n      osc.frequency.value = constants.audio.green;\n      break;\n    default:\n      assertNever(n); // Compiler will give a type error if the cases above are not exhaustive\n      throw Error(\"bad note in startPlayingSound: \" + n);\n  }\n\n  osc.start();\n  audio.playingSound = osc;\n  if (dur !== undefined) {\n    osc.stop(audio.context.currentTime + dur.seconds());\n  }\n\n  if (cb !== undefined) {\n    osc.onended = cb;\n  }\n\n}\n\n/** Stop playing any sound without calling any onended callback */\nexport function resetPlayingSound(audio: AudioState): void {\n\n  if (audio.playingSound) {\n    audio.playingSound.onended = (): void => { /* do nothing */ };\n    try {\n      audio.playingSound.stop();\n    } catch (e) {\n      if (e.name === \"InvalidStateError\") {\n        log(\"Ignored InvalidStateError in stop() during resetPlayingSound - Safari workaround\");\n      } else {\n        log(\"Ignored unexpected error in stop\", e);\n      }\n    }\n    audio.playingSound = null;\n  }\n\n}\n\n\n/** Play the failure sound and follow the given callback when sound ends */\nexport function playFailureSound(audio: AudioState, cb: (() => void)): void {\n\n  let osc: OscillatorNode | undefined = audio.context.createOscillator();\n  if (!osc) {\n    throw Error(\"Failed to create oscillator node\");\n  }\n  osc.type = \"square\";\n  osc.connect(audio.gainNode);\n  osc.frequency.value = constants.audio.failure;\n\n  osc.start();\n  osc.stop(audio.context.currentTime + constants.durations.failureSound.seconds());\n  osc.onended = cb;\n\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/sound.ts\n **/","/*\n * Utiity functions\n *\n */\n\nimport { Duration } from \"./duration\";\nimport * as consoleLog from \"./consoleLog\";\n\n/** Run the given function when document load is complete */\nexport function runWhenDocumentReady(fn: () => void): void {\n\n  if (document.readyState !== \"loading\") {\n    fn();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", fn);\n  }\n\n}\n\n/** Used in default clauses of switch statements where the compiler should be able to tell that the\n * cases are exhaustive. Taken from https://github.com/Microsoft/TypeScript/pull/9163#issuecomment-226038986\n */\nexport function assertNever(x: never): never {\n    throw new Error(\"Unexpected object: \" + x);\n}\n\n/** Distance between two points */\nexport function dist(x1: number, y1: number, x2: number, y2: number): number {\n\n  return Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n\n}\n\n/** Return the rendering context from the given canvas, throws on failure  */\nexport function getContext2D(cvs: HTMLCanvasElement): CanvasRenderingContext2D {\n  let c: CanvasRenderingContext2D | null = cvs.getContext(\"2d\");\n  if (c) {\n    return c;\n  } else {\n    throw Error(\"Cannot get canvas context\");\n  }\n}\n\n/** Wrapped version of setTimeout which takes a Duration (or null for zero) and reverses argument order */\nexport function timeout(dur: Duration | null, cb: () => void): void {\n  setTimeout(cb, dur === null ? 0 : dur.millseconds(), cb);\n}\n\nexport function eventLog(triggerName: string | null | undefined, target: string | null | undefined,  action: string | undefined): void {\n  consoleLog.fixed([6, 0, 12, 0, 0], triggerName, \" \", target, \" : \", action);\n}\n\nexport function stepLog(stepName: string | null | undefined, message: string | undefined): void {\n  consoleLog.fixed([6, 0, 12, 0, 0], stepName, \" \", (Date.now() % 100000).toString(), \" : \", message);\n}\n\nexport function log(...args: any[]): void {\n  consoleLog.free.apply(null, args);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils.ts\n **/","/*\n * Provide lightly structured output to console.log() switched on by either\n * DEBUG environment variable existing or the localstorage debug string existing and not being empty, \"0\" or \"false\" (case insensitive)\n *\n * We use the format console.log(\"%s %f\", \"Hi\", 2) instead of just console.log(\"Hi\", 2) as the latter shows across multi-lines in Safari\n *\n * Intended use within code:\n *  import * as consoleLog from \"consoleLog\";\n *  consoleLog.fixed([10, 10], \"A\", \"B\", \"C\"); // pads the first two fields to 10 spaces (and truncates if longer)\n *  consoleLog.free(\"A\", \"B\", \"C\"); // space sepearated\n *\n * Then to active logging under node:\n *  DEBUG=YES node prog.js\n *\n * Or to activate in the browser, use (in the console window)\n *  window.localStorage.settItem(\"debug\", 1)\n * And to deactivate\n *  window.localStorage.setItem(\"debug\", 0)\n *\n * Disadvantages of this module\n *  - In browser logging shows the filename of the line number of the fuction in this file, not the caller\n *  - In Safari, the font is not fixed width so the fixed() function has little impact\n *\n */\n\n/** If debugging activated, pass all the argyments as a substituted string to console.log after padding/truncating to given widths (if non-zero) */\nexport function fixed(widths: number[], ...args: any[]): void {\n  if (debugging()) {\n    let paddedArgs: string[] = args.map((x: any, i: number): string => padTo(expandUN(x), widths[i]));\n    console.log.apply(console, [typeTemplate(paddedArgs)].concat(paddedArgs));\n  }\n}\n\n\n/** If debugging is activated, pass all the arguments as a substituted string to console.log */\nexport function free(...args: any[]): void {\n\n  if (debugging()) {\n    console.log.apply(console, [typeTemplate(args)].concat(args));\n  }\n\n}\n\n/** We are not building with the node.d.ts (as we don't really use node), so need to declare this for typescript */\ndeclare var process: { env: any };\n\n/** Helper function to see if debugging has been turned on by localStorage or environment variable */\nfunction debugging(): boolean {\n  if (typeof window !== \"undefined\" && window.localStorage)  {\n    let d: string = window.localStorage.getItem(\"debug\");\n    return d !== \"\" && d !== \"0\" && d.toLowerCase() !== \"false\";\n  }\n  if (typeof process !== \"undefined\" && process.env && process.env.DEBUG) {\n    return true;\n  }\n  return false;\n}\n\n/** Helper function to turn undefined and null into a string, passing through anything else */\nfunction expandUN(s: any): any {\n  if (s === null) {\n    return \"null\";\n  } else if (s === undefined) {\n    return \"undefined\";\n  }\n  return s;\n}\n\n/** Helper function to truncate or right-pad the string (with spaces) to given width; does nothing if width is non-positive or argument */\nfunction padTo(x: any, width: number | undefined): string {\n\n  if (!width || width <= 0) {\n    return x;\n  }\n\n  let s: string = x.toString();\n\n  let paddingNeeded: number = width - s.length;\n  if (paddingNeeded > 0) {\n    return s + \"                                                                      \".substr(0, paddingNeeded);\n  } else {\n    return s.substr(0, width);\n  }\n\n}\n\n/** Helper function to provide a template for console.log string substitution based on the types of the given arguments */\nfunction typeTemplate(args: any[]): string {\n  return args.map((x: any): string => {\n    switch (typeof x) {\n      case \"string\":\n      case \"undefined\":\n      case \"null\":\n        return \"%s\";\n      case \"number\":\n        return \"%f\";  // There is also a %i available for integers, but we just use the float template for all numbers\n      default:\n        return \"%o\";\n    }\n  }).join(\" \");\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/consoleLog.ts\n **/","// shim for using process in browser\n\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\n(function () {\n  try {\n    cachedSetTimeout = setTimeout;\n  } catch (e) {\n    cachedSetTimeout = function () {\n      throw new Error('setTimeout is not defined');\n    }\n  }\n  try {\n    cachedClearTimeout = clearTimeout;\n  } catch (e) {\n    cachedClearTimeout = function () {\n      throw new Error('clearTimeout is not defined');\n    }\n  }\n} ())\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = cachedSetTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    cachedClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        cachedSetTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/process/browser.js\n ** module id = 9\n ** module chunks = 0\n **/","/*\n * Provides event handlers for top-level event logic (detect which button, filter for power on and do redraws of\n * any previously depressed buttons etc). Actual handling of valid events passed to functions from handlers.ts\n *\n */\n\nimport { redrawButton } from \"./board\";\nimport constants, { BoardDimensions } from \"./constants\";\nimport { handlePowerClick, handleStrictClick, handleStartClick, handleNoteDown, handleUpFromNote } from \"./handlers\";\nimport { State, CanvasButton } from \"./state\";\nimport { assertNever, dist, eventLog } from \"./utils\";\n\n/** Shortcut to constants.boardDimensions to reduce verbosity */\nconst dim: BoardDimensions = constants.boardDimensions;\n\n/** Callback function that handles clicks on the canvas */\nexport function canvasClickHandler(state: State, event: MouseEvent): void {\n\n  let clicked: CanvasButton | null = findCanvasButton(scaledCoords(state, event.pageX, event.pageY));\n\n  if (state.power) {\n\n    switch (clicked) {\n\n      case \"PowerButton\":\n        handlePowerClick(state);\n        break;\n      case \"StrictButton\":\n          handleStrictClick(state);\n        break;\n      case \"StartButton\":\n        handleStartClick(state);\n        break;\n\n      // Clicks on note buttons are ignored (we instead handle mouse up/down)\n      case \"BlueButton\":\n      case \"RedButton\":\n      case \"YellowButton\":\n      case \"GreenButton\":\n        eventLog(\"Click\", clicked, \"ignored click on note button\");\n        break;\n\n      case null:\n        eventLog(\"Click\", clicked, \"ignored null click\");\n        break;\n      default:\n        assertNever(clicked); // TS Compiler will throw an error if above cases are not exhaustive\n    }\n\n  } else { // power is off\n\n    if (clicked === \"PowerButton\") {\n\n      handlePowerClick(state);\n\n    } else {\n\n      eventLog(\"Click\", clicked, \"ignored as power off\");\n\n    }\n\n  }\n\n  clearDepressed(state, clicked); // if we have a stray note lit up, unlight it\n\n}\n\n/** Callback function to handle mouse down events on our canvas */\nexport function canvasMouseDownHandler(state: State, event: MouseEvent): void {\n\n  if (state.power) { // ignore all mouse downs if power is off\n\n    let down: CanvasButton | null = findCanvasButton(scaledCoords(state, event.pageX, event.pageY));\n\n    switch (down) {\n      case \"RedButton\":\n      case \"YellowButton\":\n      case \"BlueButton\":\n      case \"GreenButton\":\n        handleNoteDown(state, down);\n        break;\n      case \"StartButton\":\n      case \"StrictButton\":\n      case \"PowerButton\":\n      case null:\n        eventLog(\"Down\", down, \"ignored down on control/null button\");\n        clearDepressed(state, down); // if we have a stray note lit up, unlight it\n        break;\n      default:\n        assertNever(down); // Compiler will throw a type error if cases are not exhaustive\n    }\n\n  }\n\n}\n\n/** Return a callback function to handle mouseup and mouseout events on our canvas */\nexport function canvasMouseUpOrOutHandler(state: State, event: MouseEvent): void {\n\n    if (state.power) {  // ignore all mouse ups if power is off\n\n      switch (state.depressed) {\n        case \"RedButton\":\n        case \"YellowButton\":\n        case \"BlueButton\":\n        case \"GreenButton\":\n          handleUpFromNote(state);\n          break;\n\n        case \"StartButton\":\n        case \"StrictButton\":\n        case \"PowerButton\":\n        case null:\n          eventLog(\"Up\", \"\", \"ignored from \" + state.depressed);\n          break;\n        default:\n          assertNever(state.depressed); // Compiler will throw a type error if cases are not exhaustive\n      }\n\n    }\n\n}\n\n/** Helper function to turn clicks in our normalized coordinates to buttons  */\nfunction findCanvasButton(coords: [number, number]): CanvasButton | null {\n\n  let x: number = coords[0];\n  let y: number = coords[1];\n  let r: number = Math.sqrt(x * x + y * y);\n\n  if (r > dim.innerBorderOutsideRadius && r < dim.outerBorderInsideRadius) {\n\n    if (Math.abs(x) > dim.stripeWidth / 2 && Math.abs(y) > dim.stripeWidth / 2) {\n\n      let theta: number = Math.atan2(y, x);\n      if (theta > Math.PI / 2 ) {\n        return \"YellowButton\";\n      } else if (theta > 0) {\n        return \"BlueButton\";\n      } else if (theta < - Math.PI / 2) {\n        return \"GreenButton\";\n      } else {\n        return \"RedButton\";\n      }\n    }\n  }\n\n  if (r < dim.innerBorderInsideRadius) {\n\n    if (dist(x, y, - 0.5 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3) < dim.centralButtonRadius) {\n      return \"PowerButton\";\n    }\n    if (dist(x, y, 0 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3) < dim.centralButtonRadius) {\n      return \"StartButton\";\n    }\n    if (dist(x, y, + 0.5 * dim.innerBorderInsideRadius, dim.innerBorderInsideRadius * 0.3) < dim.centralButtonRadius) {\n      return \"StrictButton\";\n    }\n\n  }\n\n  return null;\n\n}\n\n\n/** Helper function to return scaled coordinates */\nfunction scaledCoords(state: State, pageX: number, pageY: number): [number, number] {\n\n  // Pixel coordinates of click relative to canvas\n  let pixelX: number = pageX - state.canvas.offsetLeft;\n  let pixelY: number = pageY - state.canvas.offsetTop;\n\n  // Coordinates on our -100..100 system\n  let x: number = (pixelX - state.canvas.width / 2) / state.scale;\n  let y: number = (pixelY - state.canvas.height / 2) / state.scale;\n\n  return [x, y];\n\n}\n\n\n/** Helper function to handle an old depressed button, does nothing if old depressed button is the same as the one as the given button */\nfunction clearDepressed(state: State, newButton: CanvasButton | null): void {\n\n    let oldDepressed: CanvasButton | null = state.depressed;\n    if (oldDepressed && oldDepressed !== newButton) {\n      redrawButton(state, oldDepressed);\n    }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event.ts\n **/","/*\n * Event handlers for specific events interactions on our buttons\n *\n */\n\nimport { flashScore, redrawBoard, redrawButton, redrawNotes, redrawScore } from \"./board\";\nimport constants from \"./constants\";\nimport { setReplayTimeout } from \"./replay-timeout\";\nimport { startPlayingSound, resetPlayingSound, playFailureSound } from \"./sound\";\nimport { State, CanvasButton, buttonToNote, resetState } from \"./state\";\nimport { resetTune, extendTune, playTune } from \"./tune\";\nimport { eventLog, timeout } from \"./utils\";\n\n/** Handle a click on the power button */\nexport function handlePowerClick(state: State): void {\n\n  eventLog(\"Click\", \"PowerButton\", \"redrew\");\n\n  if (state.power) { // Powering down - reset and redraw everything\n\n    resetPlayingSound(state.audio);\n    resetState(state);\n    redrawBoard(state);\n\n  } else { // We are powering on\n\n    state.power = true;\n    state.score = \"Dashes\";\n    redrawScore(state);\n    redrawButton(state, \"PowerButton\");\n\n  }\n\n}\n\n/** Handle a click on the strict button (with power on) */\nexport function handleStrictClick(state: State): void {\n\n  eventLog(\"Click\", \"StrictButton\", \"redrew\");\n\n  state.strict = !state.strict;\n\n  redrawButton(state, \"StrictButton\");\n\n}\n\n/** Handle a click on the start button (with power on) */\nexport function handleStartClick(state: State): void {\n\n    eventLog(\"Click\", \"StartButton\", \"start sequence beginning\");\n    newRound(state);\n\n}\n\n/** Handle a mouseDown event on a note Button given that power is on */\nexport function handleNoteDown(state: State, b: CanvasButton): void {\n\n  if (state.notesMatched !== null) { // if we are in replay mode\n\n    eventLog(\"Down\", \"b\", \"note down during replay phase\");\n\n    state.depressed = b;\n    eventLog(\"Down\", b, \"redrew as depressed\");\n    redrawButton(state, b);\n\n    if (buttonToNote(b) === state.tune[state.notesMatched]) { // Correct note\n\n      startPlayingSound(state.audio, buttonToNote(b), undefined, () => endPlayingNote(state));\n\n    } else { // Wrong note\n\n      replayFailure(state, b);\n\n    }\n\n  } else {\n\n    eventLog(\"Down\", \"b\", \"note down outside replay, ignored\");\n\n  }\n\n}\n\n/** Handle a mouseDown event given that state.depressed is a note button and power is on) */\nexport function handleUpFromNote(state: State): void {\n\n  eventLog(\"Up\", undefined, \"from note, stops sound \");\n  resetPlayingSound(state.audio);\n  if (state.depressed !== null) {\n    endPlayingNote(state);\n  }\n\n}\n\n/** Helper function to handle the ending of the playing of a correct note as part of replay */\nfunction endPlayingNote(state: State): void {\n\n  if (state.notesMatched !== null) {\n    if (state.depressed !== null) { // combining these two conditions confuses the Typescript null checker\n\n      // Unlight the button\n      const oldPlaying: CanvasButton = state.depressed;\n      state.depressed = null;\n      redrawButton(state, oldPlaying);\n\n      state.notesMatched = state.notesMatched + 1;\n\n      if (state.notesMatched >= state.tune.length) { // We have finished the replay for this tune\n\n        if (state.notesMatched >= constants.game.winCondition) { // We have won the game\n\n          flashScore(state, \"Win\", 5, () => { // Flash success and restart\n            timeout(constants.durations.afterFailure, () => newRound(state));\n          });\n\n        } else { // Game is not over, pause and start a new extended tune\n\n          timeout(constants.durations.afterReplay, () => {\n            extendTune(state);\n            redrawScore(state);\n            playTune(state, 0);\n          });\n\n        }\n      } else { // we have not finished the replay for this tune, so set timeout to wait for the next note\n\n        setReplayTimeout(state);\n\n      }\n\n    }\n  }\n\n}\n\n/** Helper function to start a new round */\nfunction newRound(state: State): void {\n\n      flashScore(state, \"Dashes\", 3, () => {\n\n        resetTune(state);\n        extendTune(state);\n\n        redrawScore(state);\n        playTune(state, 0);\n\n    });\n\n}\n\n/** Replay has failed - play failure sound and restart; unlights the button provided if any */\nexport function replayFailure(state: State, b: CanvasButton | null): void {\n\n  // If note is still playing (as this function was called from a timeout), stop it\n  if (state.audio.playingSound) {\n    state.audio.playingSound.stop();\n    state.audio.playingSound = null;\n  }\n\n  playFailureSound(state.audio, () => { // Play failure sound and then clear the note button\n    state.depressed = null;\n    if (b) {\n      redrawButton(state, b);\n    } else {\n      redrawNotes(state); // If failure from a timeout,redraw all the notes\n    }\n  });\n\n  state.notesMatched = null;\n  flashScore(state, \"Plings\", 3, () => { // Flash failure\n\n    timeout(constants.durations.afterFailure,   () => { // Pause and then...\n\n      if (state.strict) { // Go back to beginning of the round if we are in strict mode\n\n        newRound(state);\n\n      } else { // Start replay again if non-strict\n\n        state.score = state.tune.length;\n        redrawScore(state);\n        playTune(state, 0);\n        state.notesMatched = 0;\n\n      }\n    });\n\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/handlers.ts\n **/","/**\n * Support setting timeouts during replay phase, and then when they are called checking the relevant\n * portion of the game state and, if it has not advanced, trigger replayFailure\n *\n */\n\nimport constants from \"./constants\";\nimport { replayFailure } from \"./handlers\";\nimport { State } from \"./state\";\nimport { eventLog, timeout } from \"./utils\";\n\n/** Portion of State that is relevant for checking if the timeout during replay phase should be acted on when it triggers */\ninterface ReplayState {\n  id: number;\n  match: number | null;\n}\n\n/** Establish timeout for replays */\nexport function setReplayTimeout(state: State): void {\n\n  const oldR: ReplayState = makeReplayState(state); // Relevant game state when the timeout is set\n\n  eventLog(\"TOSET\", null, \"Setting replay timeout at \" + showReplayState(oldR));\n\n  timeout(constants.durations.replayWait, () => {\n\n    const newR: ReplayState = makeReplayState(state); // Relevant game state when the timeout is triggered\n\n    eventLog(\"TOCHK\", null, `Was ${showReplayState(oldR)}, now ${showReplayState(newR)}`);\n\n    // If relevant game state has not changed and the power is on, then replay has failed\n    if (state.power && equalReplayState(oldR, newR)) {\n      eventLog(\"TOFAIL\", null, \"Failure triggered\");\n      replayFailure(state, null);\n    }\n  });\n\n}\n\n/** Helper function to construct a ReplayState */\nfunction makeReplayState(state: State): ReplayState {\n  return {\n    id: state.id,\n    match: state.notesMatched\n  };\n}\n\n/** Helper function to produce a string representation of a ReplayState for debugging messages */\nfunction showReplayState(r: ReplayState): string {\n  return `(${r.id}, ${r.match})`;\n}\n\n/** Helper function to test two replay states for value equality */\nfunction equalReplayState(r1: ReplayState, r2: ReplayState): boolean {\n  return r1.id === r2.id && r1.match === r2.match;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/replay-timeout.ts\n **/","/*\n * Manage playing the tune for the player to follow\n *\n */\n\nimport { redrawButton } from \"./board\";\nimport constants from \"./constants\";\nimport { setReplayTimeout } from \"./replay-timeout\";\nimport { startPlayingSound } from \"./sound\";\nimport { Note, State, noteToButton } from \"./state\";\nimport { stepLog, timeout } from \"./utils\";\n\n/** Reset the current tune (e.g., after pressing Start button) */\nexport function resetTune(state: State): void {\n\n  state.tune = [];\n\n}\n\n/** Add a random note to the tune */\nexport function extendTune(state: State): void {\n\n state.tune.push(randomNote());\n state.score = state.tune.length;\n\n}\n\n/** Play the tunye starting from the given note (calls itself recursively to iterate over the whole tune) */\nexport function playTune(state: State, i: number): void {\n\n  stepLog(\"Play\" + i, \"starting\");\n\n  // Incremenent id whenever we start playing a new tune\n  if (i === 0) {\n    state.id = state.id + 1;\n  }\n\n  if (i < state.tune.length) { // if we still have notes to play\n\n    let nextNote: Note = state.tune[i];\n\n    state.playing = nextNote;\n    state.notesMatched = null;\n    redrawButton(state, noteToButton(nextNote));\n\n    startPlayingSound(state.audio, nextNote, constants.durations.tuneNote, () => {\n\n      state.playing = null;\n      redrawButton(state, noteToButton(nextNote));\n\n      timeout(i < state.tune.length - 1 ? constants.durations.tuneGap : null, () => playTune(state, i + 1), );\n\n    });\n\n  } else { // tune finished\n\n    stepLog(\"Play\", \"finished, notesMatched to zero\");\n    state.notesMatched = 0;\n    setReplayTimeout(state);\n\n  }\n\n\n}\n\n/** Helper function to return a random note */\nfunction randomNote(): Note {\n\n  switch (Math.floor(Math.random() * 4)) {\n    case 0: return \"BlueNote\";\n    case 1: return \"YellowNote\";\n    case 2: return \"GreenNote\";\n    case 3: return \"RedNote\";\n    default: throw Error(\"Unknown note in randomNote\");\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tune.ts\n **/"],"sourceRoot":""}